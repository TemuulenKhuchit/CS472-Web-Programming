<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lab 9</title>
    <link rel="stylesheet" href="./css/styles.css" />
  </head>
  <body>
    <div class="container">
      <h1>Lab 9</h1>

      <h2>Module & creating HTTP server</h2>
      <h3>Question 1:</h3>
      <p>What will be outputs in ES module and CommonJS?</p>

      <div class="answer-label">Code:</div>
      <pre class="code-block">
import fs from "fs";

process.nextTick(() => console.log("nextTick 1"));

Promise.resolve().then(() => console.log("promise 1"));

setImmediate(() => {
  console.log("setImmediate 1");
});

setTimeout(() => console.log("setTimeout 1"), 0);

fs.readFile("./files/input.txt", "utf-8", (err, data) => {
  if (err) console.log("there is an error. can not read from file");
  else {
    console.log(data);
  }
});        
      </pre>

      <div class="answer-label">Answer:</div>
      <pre class="code-block">
nextTick 1
promise 1
setTimeout 1
setImmediate 1
File contents
      </pre>

      <h3>Question 2:</h3>
      <p>Create a web server using http module:</p>
      <ol>
        <li>
          If the path is '/image' and method is GET, send a response of an image to any client. Set an appropriate
          content-type for your image.
        </li>
        <li>
          If the path is '/pdf' and method is GET, send a response of a pdf file to any client. Set a Content-type as
          "application/pdf".
        </li>
        <li>
          If the path is '/about' and method is GET, send a response of a txt file to any client. Set a Content-type as
          "text/plain".
        </li>
        <li>
          If the path is '/home' or '/' and method is GET, send “Welcome to my website” text. Otherwise return not found
          with status code 404.
        </li>
      </ol>

      <div class="answer-label">Answer:</div>
      <pre class="code-block">
const http = require('http');
const fs = require('fs');

const server = http.createServer((req, res) => {
  if (req.method === 'GET') {
    if (req.url === '/image') {
      res.writeHead(200, { 'Content-Type': 'image/jpeg' });
      fs.createReadStream('./path-to-image.jpg').pipe(res);
    } else if (req.url === '/pdf') {
      res.writeHead(200, { 'Content-Type': 'application/pdf' });
      fs.createReadStream('./path-to-pdf.pdf').pipe(res);
    } else if (req.url === '/about') {
      res.writeHead(200, { 'Content-Type': 'text/plain' });
      fs.createReadStream('./path-to-about.txt').pipe(res);
    } else if (req.url === '/home' || req.url === '/') {
      res.writeHead(200, { 'Content-Type': 'text/plain' });
      res.end('Welcome to my website');
    } else {
      res.writeHead(404, { 'Content-Type': 'text/plain' });
      res.end('404 Not Found');
    }
  } else {
    res.writeHead(405, { 'Content-Type': 'text/plain' });
    res.end('Method Not Allowed');
  }
});

server.listen(3000, () => {
  console.log('Server is running on http://localhost:3000');
});
      </pre>
    </div>
  </body>
</html>
