<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lab 10</title>
    <link rel="stylesheet" href="./css/styles.css" />
  </head>
  <body>
    <div class="container">
      <h1>Lab 10</h1>

      <h2>Topic: Express</h2>

      <h3>Exercise 1:</h3>
      <p>Convert the Lab09 Question2 to the Express application.</p>
      <div class="answer-label">Code:</div>
      <pre class="code-block">
const express = require('express');
const fs = require('fs');
const path = require('path');
const app = express();

// Route to serve the image
app.get('/image', (req, res) => {
  const imagePath = path.join(__dirname, 'path-to-image.jpg');
  res.setHeader('Content-Type', 'image/jpeg');
  const readStream = fs.createReadStream(imagePath);
  readStream.pipe(res);
});

// Route to serve the PDF
app.get('/pdf', (req, res) => {
  const pdfPath = path.join(__dirname, 'path-to-pdf.pdf');
  res.setHeader('Content-Type', 'application/pdf');
  const readStream = fs.createReadStream(pdfPath);
  readStream.pipe(res);
});

// Route to serve the text file
app.get('/about', (req, res) => {
  const textPath = path.join(__dirname, 'path-to-about.txt');
  res.setHeader('Content-Type', 'text/plain');
  const readStream = fs.createReadStream(textPath);
  readStream.pipe(res);
});

// Route to serve home
app.get(['/home', '/'], (req, res) => {
  res.send('Welcome to my website');
});

// Catch all other routes and return a 404
app.use((req, res) => {
  res.status(404).send('404 Not Found');
});

// Start the server
const port = 3000;
app.listen(port, () => {
  console.log(`Server is running on http://localhost:${port}`);
});
      </pre>

      <h3>Exercise 2:</h3>
      <p>Write an Express application to provide a calculator API.</p>
      <ul>
        <li>
          There should be an API endpoint for each basic math operation: addition, subtraction, multiplication,
          division, and modulus.
        </li>
        <li>
          Each endpoint will receive the input numbers and return a JSON response with the results as follows: {
          results: 0 }.
        </li>
        <li>
          The calculator router should be designed with flexibility to receive the input numbers as query parameters,
          parameters, or in the body as JSON or urlEncoded format, For example, all these requests will return the same
          results value { results: 5 }:
          <ul>
            <li>GET /addition/2/3</li>
            <li>GET /addition/?a=2&b=3</li>
            <li>POST /addition/ BODY ?a=2&b=3</li>
            <li>POST /addition/ BODY {a:2,b:3}</li>
          </ul>
        </li>
      </ul>
      <div class="answer-label">Code:</div>
      <pre class="code-block">
const isPrime = (n) => {
  return new Promise((resolve, reject) => {
    if (n < 2) {
      reject({ prime: false });
    } else {
      for (let i = 2, s = Math.sqrt(n); i <= s; i++) {
        if (n % i === 0) {
          reject({ prime: false });
        }
      }
      resolve({ prime: true });
    }
  });
};

// Test using Promise:
console.log('start');
isPrime(7)
  .then(console.log)
  .catch(console.error);
console.log('end');
      </pre>
      <div class="answer-label">Output:</div>
      <pre class="code-block">
// start
// end
// { prime: true }
      </pre>

      <h3>Modified Test Using Async/Await:</h3>
      <div class="answer-label">Code:</div>
      <pre class="code-block">
const checkPrime = async (n) => {
  console.log('start');
  try {
    const result = await isPrime(n);
    console.log(result);
  } catch (error) {
    console.error(error);
  }
  console.log('end');
};

// Test using async/await
checkPrime(7);
      </pre>
      <div class="answer-label">Output:</div>
      <pre class="code-block">
// start
// { prime: true }
// end
      </pre>

      <h3>Exercise 3:</h3>
      <p>
        Write an IIFE that fetch recipes from https://dummyjson.com/recipes and print to the console a list of recipe
        names:
      </p>
      <div class="answer-label">Code:</div>
      <pre class="code-block">
(async () => {
  try {
    const response = await fetch('https://dummyjson.com/recipes');
    const data = await response.json();
    const recipeNames = data.recipes.map(recipe => recipe.name);
    console.log('Recipes:', recipeNames);
  } catch (error) {
    console.error('Error fetching recipes:', error);
  }
})();
      </pre>
      <div class="answer-label">Output (Example):</div>
      <pre class="code-block">
// Recipes: ['Recipe 1', 'Recipe 2', 'Recipe 3', ...]
      </pre>
    </div>
  </body>
</html>
